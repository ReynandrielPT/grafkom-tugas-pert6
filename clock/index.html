<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Clock Viewer - WebGL</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,
          Cantarell, Noto Sans, Helvetica, Arial;
        display: flex;
        gap: 1.25rem;
        padding: 1rem;
        background: #f7f7fb;
        color: #111827;
      }
      #canvas-container canvas {
        border-radius: 12px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 12px 28px rgba(0, 0, 0, 0.12);
        background: #fff;
        cursor: grab;
      }
      #canvas-container canvas:active {
        cursor: grabbing;
      }
      .panel {
        width: 25rem;
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 1rem;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
      }
      input[type="range"] {
        width: 100%;
        accent-color: #7c3aed;
      }
      .btn {
        padding: 0.45rem 0.8rem;
        border: 1px solid #e5e7eb;
        border-radius: 10px;
        background: #fff;
        cursor: pointer;
      }
      .btn.active {
        background: #7c3aed;
        color: #fff;
        border-color: #7c3aed;
      }
    </style>
  </head>
  <body>
    <div>
      <h1
        style="
          margin: 0 0 0.5rem 0;
          font-weight: 700;
          background: linear-gradient(90deg, #111827, #7c3aed);
          -webkit-background-clip: text;
          background-clip: text;
          color: transparent;
        "
      >
        Clock Viewer
      </h1>
      <div id="canvas-container">
        <canvas id="gl-canvas" width="800" height="500"></canvas>
      </div>
    </div>

    <div class="panel">
      <h2 class="font-bold mb-2">Controls</h2>
      <div class="mb-3 text-sm text-gray-600">
        Drag to orbit, wheel to zoom. Toggle real time or play the animation.
      </div>

      <h3 class="font-semibold">Rendering</h3>
      <div class="flex gap-2 mb-2">
        <label
          ><input type="radio" name="proj" value="perspective" checked />
          Perspective</label
        >
        <label
          ><input type="radio" name="proj" value="orthographic" /> Ortho</label
        >
      </div>
      <div class="flex gap-2 mb-2">
        <label
          ><input type="radio" name="light" value="fragment" checked />
          Fragment</label
        >
        <label><input type="radio" name="light" value="vertex" /> Vertex</label>
      </div>

      <h3 class="font-semibold mt-2">Lighting</h3>
      <div class="grid grid-cols-2 gap-2 mb-2">
        <label class="col-span-2 text-sm"
          >Intensity <span id="intVal">1.00</span></label
        >
        <input
          id="lightIntensity"
          type="range"
          min="0"
          max="3"
          step="0.01"
          value="1"
        />
        <label class="col-span-2 text-sm">Shininess</label>
        <input id="shininess" type="range" min="1" max="128" value="50" />
      </div>

      <h3 class="font-semibold mt-2">Animation</h3>
      <div class="flex gap-2 mb-2">
        <button id="btnPlay" class="btn">Play</button>
        <button id="btnPause" class="btn">Pause</button>
        <button id="btnStop" class="btn">Stop</button>
        <button id="btnReset" class="btn">Reset</button>
      </div>
      <label class="text-sm">Speed</label>
      <input id="speed" type="range" min="0" max="5" step="0.05" value="2" />

      <div class="flex items-center gap-2 mt-2 mb-1">
        <input id="acRotate" type="checkbox" />
        <label for="acRotate">Rotate Model</label>
      </div>
      <label class="text-sm">Rotate Speed (deg/s)</label>
      <input
        id="acRotateSpeed"
        type="range"
        min="0"
        max="180"
        step="1"
        value="30"
      />

      <h3 class="font-semibold mt-2">Clock</h3>
      <div class="flex items-center gap-2 mb-2">
        <input id="clkRealTime" type="checkbox" />
        <label for="clkRealTime">Real Time</label>
      </div>
    </div>

    <script id="viewer-vertex-shader" type="x-shader/x-vertex">
      #version 300 es
      in vec4 aPosition; in vec3 aNormal; out vec3 N,L,E; uniform mat4 modelViewMatrix, projectionMatrix; uniform mat3 uNormalMatrix; uniform vec4 uLightPosition; void main(){ vec3 pos=(modelViewMatrix*aPosition).xyz; L=(uLightPosition.w==0.0)?normalize(uLightPosition.xyz):normalize(uLightPosition.xyz-pos); E=-normalize(pos); N=normalize(uNormalMatrix*aNormal); gl_Position=projectionMatrix*modelViewMatrix*aPosition; }
    </script>
    <script id="viewer-fragment-shader" type="x-shader/x-fragment">
      #version 300 es
      precision mediump float; in vec3 N,L,E; uniform vec4 uAmbientProduct,uDiffuseProduct,uSpecularProduct; uniform float uShininess,uLightIntensity; out vec4 fColor; void main(){ vec3 H=normalize(L+E); vec4 ambient=uAmbientProduct*uLightIntensity; float Kd=max(dot(L,N),0.0); vec4 diffuse=Kd*uDiffuseProduct*uLightIntensity; float Ks=pow(max(dot(N,H),0.0),uShininess); vec4 specular=Ks*uSpecularProduct*uLightIntensity; if(dot(L,N)<0.0) specular=vec4(0,0,0,1); fColor=ambient+diffuse+specular; fColor.a=1.0; }
    </script>
    <script id="viewer-vertex-shader-vertex" type="x-shader/x-vertex">
      #version 300 es
      in vec4 aPosition; in vec3 aNormal; out vec4 vColor; uniform mat4 modelViewMatrix, projectionMatrix; uniform mat3 uNormalMatrix; uniform vec4 uLightPosition; uniform vec4 uAmbientProduct,uDiffuseProduct,uSpecularProduct; uniform float uShininess,uLightIntensity; void main(){ vec3 pos=(modelViewMatrix*aPosition).xyz; vec3 L=(uLightPosition.w==0.0)?normalize(uLightPosition.xyz):normalize(uLightPosition.xyz-pos); vec3 E=-normalize(pos); vec3 N=normalize(uNormalMatrix*aNormal); vec3 H=normalize(L+E); vec4 ambient=uAmbientProduct*uLightIntensity; float Kd=max(dot(L,N),0.0); vec4 diffuse=Kd*uDiffuseProduct*uLightIntensity; float Ks=pow(max(dot(N,H),0.0),uShininess); vec4 specular=Ks*uSpecularProduct*uLightIntensity; if(dot(L,N)<0.0) specular=vec4(0,0,0,1); vColor=ambient+diffuse+specular; vColor.a=1.0; gl_Position=projectionMatrix*modelViewMatrix*aPosition; }
    </script>
    <script id="viewer-fragment-shader-vertex" type="x-shader/x-fragment">
      #version 300 es
      precision mediump float; in vec4 vColor; out vec4 fColor; void main(){ fColor=vColor; }
    </script>

    <script src="../MVnew.js"></script>
    <script src="../initShaders.js"></script>
    <script src="./utils/clock.js"></script>
    <script type="module" src="./main.js"></script>
  </body>
</html>
